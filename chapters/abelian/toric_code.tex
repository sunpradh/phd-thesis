%----------------------------------------
% SECTION: Toric Code and its features
%----------------------------------------
\section{Toric Code and its features}
\label{sec:toric_code_and_its_features}

The \ac{tc} is two-dimensional model of spin-\onehalf{} \ac{dof}, which can be regarded as an example of a pure $\Z_2$ \ac{lgt}.
We consider the model on a $L \times L$ square lattice $\Lattice$ with periodic boundary conditions.
The \ac{dof} are defined on the links $\link$ of the lattice and the link Hilbert space is $\C^2$.
The main operators used for this model are the Pauli matrices
\begin{equation}
    X_{\link} = \begin{pmatrix}
        0 & 1 \\ 1 & 0
    \end{pmatrix}
    \qand
    Z_{\link} = \begin{pmatrix}
        1 & 0 \\ 0 & -1
    \end{pmatrix},
    \label{eq:matrices_X_Z}
\end{equation}
which here have been written in the computational basis $\{\ket{0}, \ket{1}\}$, where the $Z$-matrix is diagonal.
It is important to note that these matrices $X$ and $Z$ \emph{anticommutes} on the same link.
\begin{equation}
    \acomm{X_{\link}}{Z_{\link}} = 0,
\end{equation}
while they commute with operators of other links.

The main \emph{local} operators that enters the Hamiltonian are the \emph{star operator} and \emph{plaquette operator} of the lattice.
The term \emph{star} refers to the links attached to a common vertex $v$, while by \emph{plaquette} $p$ we mean the links around a face of the lattice.
A \emph{star operator} and a \emph{plaquette operator} are respectively defined as
\begin{equation}
    A_v = \prod_{\link \in v} Z_\link, \qquad
    B_p = \prod_{\link \in p} X_\link.
    \label{eq:star_plaq_op_def}
\end{equation}
where $v$ is a vertex and $p$ a plaquette (see Fig.~\ref{fig:toric_code_operators}).
One can easily see that
\begin{equation}
    \comm{A_v}{A_{v^{\prime}}} = 0 \qand
    \comm{B_p}{B_{p^{\prime}}} = 0
    \label{eq:star_plaq_op_comm_1}
\end{equation}
for all vertices $v$ and $v^{\prime} $, and all plaquettes $p$ and $p^{\prime} $.
But it is also true that
\begin{equation}
    \comm{A_v}{B_p} = 0
    \label{eq:star_plaq_op_comm_2}
\end{equation}
for all $v$ and $p$.
This is because a star and a plaquette share zero or two links, so the signs factors from the anticommutation of $X$ and $Z$ cancel out.
The eigenvalues of the Pauli matrices are just $\pm 1$, so the same holds true for $A_s$ and $B_p$.
Moreover, like the Pauli matrices, also $A_s^2 = \identity$ and $B_p^2 = \identity$.


Now, given the operators in \eqref{eq:star_plaq_op_def}, we can write down the Hamiltonian of the \ac{tc}:
\begin{equation}
    \HamilTC = - \sum_{v} A_v - \sum_{p} B_p
    \label{eq:toric_code_hamiltonian}
\end{equation}
which is \emph{exactly solvable}, due to \eqref{eq:star_plaq_op_comm_1} and \eqref{eq:star_plaq_op_comm_2}.


\begin{figure}[t]
    \SideFigure[label={fig:toric_code_operators}, desc={Vertex and plaquette operators of the \ac{tc}}]{ %
        \input{assets/figures/star_plaq_operators_toric.tex}
    }{%
        Graphical representation of the vertex operator $A_v$ and plaquette operator $B_p$, defined in \eqref{eq:star_plaq_op_def}.
    }
\end{figure}



%
% SUBSECTION: Topological ground states
%
\subsection{Topological Ground states}
\label{sub:topological_ground_states}

Given the commutation relations of the $A_v$ and $B_p$ operators in \eqref{eq:star_plaq_op_comm_1} and \eqref{eq:star_plaq_op_comm_2}, one can find the ground state $\ket{\Omega}$ by simply imposing the constraints
\begin{equation}
    A_v \ket{\Omega} = \ket{\Omega} \qand
    B_p \ket{\Omega} = \ket{\Omega}, \qquad \forall v,\, p.
    \label{eq:ground_state_constraints}
\end{equation}
From these constraints one can explicitly construct a ground state for the \ac{tc} in the following way.
Working in the $Z$-basis, we can start from
\begin{equation}
    \ket{0}_{\text{TC}} = \bigotimes_{\link \in \Lattice} \ket{0}_{\link},
\end{equation}
which is the state where every link is in the $\ket{0}$, where $Z \ket{0} = \ket{0}$.
This state obviously satisfy the first condition in \eqref{eq:ground_state_constraints}.

Now, regarding the $B_p$'s operators, consider a single plaquette in the state $\ket{0}_p$ where every link is in the $\ket{0}$ state.
The action of $B_p$ flips the state of every link, from $\ket{0}$ to $\ket{1}$, obtaining $\ket{1}_p$.
Therefore, a plaquette is in an eigenstate of $B_p$ if is in an equal superposition of $\ket{0}_p$ and $\ket{1}_p$.
Knowing this, it is straightforward to see that the operator $(\identity + B_p)/\sqrt{2}$ generates an eigenstate of $B_p$ from $\ket{0}_p$.
In fact, a simple calculation
\begin{equation}
    B_p \frac{\identity + B_p}{\sqrt{2}} \ket{0}_p = \frac{B_p + \identity}{\sqrt{2}} \ket{0}_p
\end{equation}
shows that we obtain an eigenstate of $B_p$ with eigenvalue $+1$, due to $B_p^2 = \identity$.

Therefore, we can obtain a ground state for the \ac{tc} Hamiltonian
\begin{equation}
    \ket{\Omega} = \prod_{p} \frac{\identity + B_p}{\sqrt{2}} \ket{0}_{\text{TC}}.
\end{equation}
More generally, we can define the space of ground states
\begin{equation}
    \mathcal{G} = \qty{ \ket{\Omega} : A_s \ket{\Omega} = \ket{\Omega}, \quad B_p \ket{\Omega} = \ket{\Omega} \quad \forall s, p },
    \label{eq:TC_protected_subspace}
\end{equation}
whose content \emph{depends on the topology of the lattice}.
For example, we will show that with \emph{periodic boundary conditions} then there are
\emph{four degenerate ground states}.


Consider a lattice $\Lattice$ of size $L \times L$ with periodic boundary conditions in both directions, i.e.~a torus.
From \eqref{eq:ground_state_constraints}, we have $2L^2$ constraints.
These are not all independent because if we multiply them all, we obtain
\begin{equation}
    \prod_{v} A_v = \identity \qand
    \prod_{p} B_p = \identity,
\end{equation}
which actually means that there are $2L^2 - 2$ independent conditions.
The total Hilbert space has dimension $2^{2L^2}$.
Combined with $2L^2 - 2$ independent conditions we obtain $2^{2L^2 - 2L^2 + 2} = 4$ independent states.
Therefore, $\dim \mathcal{G} = 4$ because we have four degenerate distinct ground states.
These are eigenstates of all $A_v$ and $B_p$, with all the same eigenvalues.
Any other that commutes with the Hamiltonian is given by a product of $A_v$ and $B_p$, so it cannot distinguish the different ground states.


The only way to distinguish these ground states is through \emph{non-local operators} that commute with the Hamiltonian in \eqref{eq:toric_code_hamiltonian}.
Non-local in this instance means not expressible as a product or sum of vertex and plaquette operators.
But first let look more closely at \emph{local operators}.


Consider any region $\mathcal{R}$ on the lattice $\Lattice$.
Without loss of generality, let $\mathcal{R}$ be a connected region, which means it is just a set of jointed plaquettes.
On this region $\mathcal{R}$ we can define a local operator $W$ as a product of $B_p$ operators:
\begin{equation}
    W = \prod_{p \in \mathcal{R}} B_p.
\end{equation}
This operator commutes will the terms of the Hamiltonian \eqref{eq:toric_code_hamiltonian}.
Due to $X^2_{\link} = \identity$, the previous equation can be rewritten as
\begin{equation}
    W = \prod_{\link \in \partial \mathcal{R}} X_{\link}.
\end{equation}
In other words, $W$ is equivalent to the product of $X$'s along the closed curve given by the boundary $\partial \mathcal{R}$ of $\mathcal{R}$.
In fact, the $B_p$ themselves are defined as product of $X$'s along a closed curve, the plaquette.
In a sense, they are all \emph{string operators} on closed curves.

The same argument can be repeated for $A_v$ with the minor caveat that the dual lattice have to considered.
In the dual lattice $\DualLattice$, to each plaquette $p$ of $\Lattice$ corresponds a vertex $v^{\ast}$ on the dual lattice.
Then, to each link $\link$ in $\Lattice$ corresponds a link $\link^{\ast}$ in $\DualLattice$ in the perpendicular direction.
In this way, a star becomes a plaquette in the dual lattice and we can repeat the same argument.
% From here, we can repeat the same argument.
Consider a region $\mathcal{R}^{\ast}$ a local operator $S$ such that
\begin{equation}
    S = \prod_{v \in \mathcal{R}^{\ast}} A_v,
\end{equation}
and, due to $Z^2_{\link} = \identity$, this is equal to
\begin{equation}
    S = \prod_{\link \in \partial \mathcal{R}^{\ast}} Z_{\link}.
\end{equation}
The local operator $S$ is a string of $Z$'s operators along the closed curve given by the boundary $\partial \mathcal{R}$ in $\DualLattice$.
The same can be said for $A_v$, it is a string operator around the smallest possible curve in $\DualLattice$.
% Indeed, a star on the direct lattice becomes a plaquette on the dual lattice.
% So a product of $A_v$ is equivalent to a string of $Z$ operators along closed curves on the dual lattice.
% All these curve have a common property, they are \emph{contractible}, meaning that they can be continuously deformed to a single point.
% The operators we have called local so far are string operators over contractible curves, but if we are on a lattice with non-trivial topology, like a torus, then we can also have \emph{non-contractible} curves.
We can conclude that all the local operators that commutes with Hamiltonian are just string operators over closed curve in either $\Lattice$ or $\DualLattice$.
But, these operators have all a common feature, they are defined on \emph{contractible} curves.
Meaning that they can be ``continuously'' deformed to a single point.

\begin{figure}[t]
    \SideFigure[label=fig:nonlocal_operators_TC, desc={Non-local operators in the \ac{tc}}]{%
        \input{assets/figures/nonlocal_operators_toric.tex}
    }{%
        Graphical representation of the different types of non-local operators.
        On the non-contractible loops $\mathcal{L}_1$ and $\mathcal{L}_2$ (in the direct lattice) we have defined $\Wilson_1$ and $\Wilson_2$ (see \eqref{eq:nonlocal_W_toric} ).
        While on the non-contractible cuts $\mathcal{C}_1$ and $\mathcal{C}_2$ (in the dual lattice) we have the operators $\overline{S}_1$ and $\overline{S}_2$.
    }
\end{figure}


String operators on non-contractible curves, either on the direct or dual lattice, are the non-local operators we have been looking for distinguish the states in $\mathcal{G}$.
Consider two non-contractible loops $\mathcal{L}_{1}$ and $\mathcal{L}_{2}$ on $\Lattice$ along the $\hat{1}$ and $\hat{2}$ direction respectively, like in Fig.~\ref{fig:nonlocal_operators_TC}.
On these paths we can define the string operators $\Wilson_1$ and $\Wilson_2$ as
\begin{equation}
    \Wilson_1 = \prod_{\link \in \mathcal{L}_1} X_\link, \qquad
    \Wilson_2 = \prod_{\link \in \mathcal{L}_2} X_\link.
    \label{eq:nonlocal_W_toric}
\end{equation}
It can be proved that they commute with all the terms of the Hamiltonian, even though they cannot be expressed as a product of them.
The same can be repeated on the dual lattice $\DualLattice$, by considering two non-contractible cuts $\mathcal{C}_1$ and $\mathcal{C}_2$ and defining $\tHooft_1$ and $\tHooft_2$ as
\begin{equation}
    \tHooft_1 = \prod_{\link \in \mathcal{C}_1} Z_\link, \qquad
    \tHooft_2 = \prod_{\link \in \mathcal{C}_2} Z_\link.
    \label{eq:nonlocal_S_toric}
\end{equation}
Likewise, the operators in \eqref{eq:nonlocal_S_toric} commutes with all the vertex and plaquettes operators but they do not commute with the operators in \eqref{eq:nonlocal_W_toric}.


In fact, \eqref{eq:nonlocal_W_toric} and \eqref{eq:nonlocal_S_toric} anticommutes,
\begin{equation}
    \acomm*{\Wilson_1}{\tHooft_2} = 0 \qand
    \acomm*{\Wilson_2}{\tHooft_1} = 0,
    \label{eq:anticommutation_W_S_toric}
\end{equation}
while
\begin{equation}
    \comm{\Wilson_1}{\Wilson_2} = 0 \qand
    \comm{\tHooft_1}{\tHooft_2} = 0.
\end{equation}
These relations can be thought as the same commutation relations of the $X$ and $Z$ gates of two qubits.

Therefore, the \ac{tc} (on a torus) has a protected subspace $\mathcal{G}$, see \eqref{eq:TC_protected_subspace}, that behaves like the Hilbert space of two qubits and the operators \eqref{eq:nonlocal_W_toric} and \eqref{eq:nonlocal_S_toric} acts like unitary gates on this space.
Unfortunately, we cannot do quantum computation with these topological qubits because there is no entangling gates.
Nonetheless they can be used for storing information in a fault-tolerant way, because in order to flip a topological qubit you would need to act with a non-local operator that involves a large amount of links.


% \subsection{Particle excitations}%
% \label{sub:particle_excitations}
%
% Until now we have only discussed the ground states of the \ac{tc}, without touching the rest of the low energy sectors.
% In other words, how do we describe the excitations of this model?
% As we said, \eqref{eq:ground_state_constraints} are the set of constraints that defines the ground states.
% Therefore, every time a given state $\ket{\Psi}$ violates these equations, we will say that it contains \emph{particles}, which can be of different types.
% If $A_v \ket{\Psi} = - \ket{\Psi}$, then we will say that the vertex $v$ contains a $z$-type particle.
% Likewise, if $B_p \ket{\Psi} = - \ket{\Psi}$, then the plaquette $p$ contains a $x$-type particle.
%
% Now the question: starting from a ground state $\ket{\Omega}$, how can we introduce some particles?
% The answer is \emph{string operators}.
% We are not considering closed strings, like we did in Sec.~\ref{sub:topological_ground_states}, but any open string.
% The shortest open string that we can consider is a single link.
% So a $Z$-string on a single link is just $Z_j$, where $j$ is a label of a generic link.
% Consider now the state
% \begin{equation}
%     \ket*{\Psi^Z} = Z_j \ket{\Omega},
% \end{equation}
% This state hosts particles at the ``boundaries'' of the $j$-th link, i.e.~the vertices touching $j$ which we call $v_0$ and $v_1$.
% This can be proved by simply showing that $[ A_v, Z_j ] = 0$ for $v \neq v_0$ and $v \neq v_1$ and $\{ A_{v_0}, Z_j \} = \{ A_{v_1}, Z_j \} = 0$.
% Which immediately implies that
% \begin{equation}
%     A_{v_0} \ket*{\Psi^Z} = A_{v_1} \ket*{\Psi^Z} = - \ket*{\Psi^Z}
% \end{equation}
%


%
% SUBSECTION: Z2 \ac{lgt}
%
\subsection{\acl{tc} as a \texorpdfstring{$\Z_2$}{Z2} \acs{lgt}}
\label{sub:toric_code_as_a_z2_lattice_gauge_theory}

The \ac{tc} was formulated as a type of error-correcting code for quantum computing, but it can be reinterpreted as a pure $\Z_2$ \ac{lgt}.
This is a type of \ac{lgt} where we allow only two possible states for the gauge field.

On a single link $\link$, we consider the $X_{\link}$ as the gauge field operator, while $Z_{\link}$ the electric field operator.
In this way, we can automatically see that the term $B_p$ is the magnetic energy because it has the same form of single-plaquette \ac{wl}.
Furthermore, the vertex operator $A_v$ can be read as a gauge transformation on the vertex $v$, because the $Z$'s operators flips the states in the $X$-basis, which would corresponds to gauge field configurations.

Now that we know the form of gauge transformations, we call a state \emph{physical} or \emph{gauge-invariant} if
\begin{equation}
    A_v \ket{\phi} = \ket{\phi} \quad \forall v \in \Lattice,
    \label{eq:toric_code_physical_state}
\end{equation}
which leads to the definition of the \emph{physical Hilbert space}:
\begin{equation}
    \Hphys = \{\ket{\phi} \; \text{s.t.} \; A_v \ket{\phi} = \ket{\phi} \quad \forall v \in \Lattice\}.
    \label{eq:phys_Hilbert_space_toric}
\end{equation}
For greater clarity, lets work in the \emph{electric basis}, which is just the $Z$-basis where the electric field is diagonal.
The electric field operator $Z$ has eigenvalue $+1$ and $-1$, corresponding respectively to the states $\ket{0}$ and $\ket{1}$.
In order to meet the condition in \eqref{eq:toric_code_physical_state}, a vertex configuration must have an even number of links in the $\ket{1}$ state (examples can be seen in Fig.~\ref{fig:gauge_inv_vertices_z2}).

\begin{figure}[t]
    \SideFigure[label=fig:gauge_inv_vertices_z2, desc={Gauge-invariant vertex states for the $\Z_2$ \ac{lgt}}]{%
        \input{assets/figures/gauge_inv_vertices.tex}
    }{%
        Gauge-invariant vertex states for the $\Z_2$ \ac{lgt}.
        Green lines represent the $\ket{1}$ link state.
    }
\end{figure}

We have already argued that the $B_p$'s give the magnetic energy, and obviously the $Z$'s give the electric energy.
Hence, the pure gauge theory Hamiltonian is just
\begin{equation}
    H^{\Z_2} = - \sum_{p} B_p - \lambda \sum_{\link} Z_{\link},
    \label{eq:z2_lgt_hamiltonian}
\end{equation}
where $\lambda$ is a generic coupling that tunes the strength of the electric field with respect to the magnetic field.
Notice that we no longer have a dynamical vertex term in \eqref{eq:z2_lgt_hamiltonian} because we have imposed the condition \eqref{eq:toric_code_physical_state} on the physical states.

In order to better explain the different phases we can have by varying the coupling $\lambda$ in \eqref{eq:z2_lgt_hamiltonian}, we want to have a closer look at the physical states.
We have already seen that the condition \eqref{eq:toric_code_physical_state} constraints the types of vertex configurations.
From the allowed configuration, we can see that the only possible lattice states (in the electric basis) are states made of \emph{closed electric loops}.
An example of such state can be seen in Fig.~\ref{fig:physical_state_z2}.


For $\lambda = 0$ we recover the \ac{tc} and its ground state can be reinterpreted as an equal superposition of all the possible configuration of closed electric loops.
This kind of phase is also called a \emph{loop condensate}.
For large $\lambda$ the electric term dominates over the magnetic term, hence all the links will favor the state $\ket{0}$.
So in the regime of strong coupling we expect to be in a \emph{polarized phase}, where the presence of electric loops is suppressed.
Therefore, there is a critical coupling $\lambda_c$ for which we have a \emph{phase transition}.
In the language of gauge theories, the loop condensate corresponds to a \emph{deconfined phase} while the polarized one is a \emph{confined phase}.
Hence, for $\lambda_c$ we have a deconfined-confined phase transition.
% \todo{inserire diagramma di fase}

\begin{figure}[t]
    \SideFigure[label=fig:physical_state_z2, desc={Physical states in the $\Z_2$ \ac{lgt}}]{%
        \input{assets/figures/physical_state.tex}
    }{%
        Physical states in the $\Z_2$ \ac{lgt} are made of closed electric loops.
    }
\end{figure}



\subsection{Super-selection sectors}
\label{sub:super_selection_sectors}

We have already seen in Sec.~\ref{sub:topological_ground_states} the non-local operators $\Wilson_{1,2}$ and $\overline{S}_{1,2}$ that can classify the topological ground states.
They can be treated on equal footing in the pure \ac{tc}, because they both commutes with all the terms of the Hamiltonian \eqref{eq:toric_code_hamiltonian}.
This is no longer true in \eqref{eq:z2_lgt_hamiltonian}, when the electric term is present.
Both kind of operators are gauge-invariant, in the sense that they commute with the gauge transformations $A_v$, i.e.
\begin{equation}
    \comm{\Wilson_{1,2}}{A_v} = 0
    \qand
    \comm{\overline{S}_{1,2}}{A_v} = 0,
    \quad \text{for all $v \in \Lattice$}
\end{equation}
but only the $\overline{S}_{1,2}$ string operator commute with the electric field $Z_{\link}$.

This means, that we can classify all the state of $\Hphys$ (see \eqref{eq:phys_Hilbert_space_toric}) through their $\overline{S}_1$ and $\overline{S}_2$ eigenvalues, because they commute with the Hamiltonian.
Therefore, we obtain a decomposition of the physical Hilbert space in super-selection sectors
\begin{equation}
    \Hphys = \Hphys^{(0,0)} \oplus \Hphys^{(0,1)} \oplus \Hphys^{(1,0)} \oplus \Hphys^{(1,1)},
    \label{eq:Hilbert_space_decomposition_Z2}
\end{equation}
where for each $\ket{\phi} \in \Hphys^{(n,m)}$ we have
\begin{equation}
    S_1 \ket{\phi} = (-1)^{m} \ket{\phi}
    \qand
    S_2 \ket{\phi} = (-1)^{n} \ket{\phi},
\end{equation}
where $n, m = 0, 1$.

The string operators $\Wilson_{1,2}$ do not commute with the Hamiltonian \eqref{eq:z2_lgt_hamiltonian}, hence they cannot be used to classify the states in $\Hphys$.
On the other hand, given the algebraic relations \eqref{eq:anticommutation_W_S_toric}, they are able to modify the effect of $\overline{S}_{1,2}$.
In fact, $\Wilson_{1,2}$ can change the super-selection sectors:
\begin{equation}
    W_1 : \Hphys^{(n,m)} \mapsto \Hphys^{(n+1,m)}
    \qand
    W_2 : \Hphys^{(n,m)} \mapsto \Hphys^{(n,m+1)},
    \label{eq:action_W_on_sectors}
\end{equation}
where the $n,m = 0, 1$ and the addition is taken modulus $2$.


\begin{figure}[t]
    \centering
    \input{assets/figures/sector_mapping.tex}
    \vspace*{-0.5cm}
    \caption[States in different super-selection sectors]{%
        Pictorial representation of states of different super-selection sector and the action of the string operator $W_2$.
        Notice that the action $\Wilson_2$ introduces a non-contractible electric loop in the state, which modifies the value of $\overline{S}_1$, which, in a sense, measure the presence of non-contractible electric loops in the orthogonal direction $\hat{2}$.%
        }
    \label{fig:sector_mapping}
\end{figure}

From a more physical point of view, the operator $\overline{S}_i$ (with $i=1,2$) measures the presence non-contractible electric loops in the state in the direction orthogonal to $\hat{i}$.
Therefore, the decomposition in \eqref{eq:Hilbert_space_decomposition_Z2} divides the physical Hilbert space by the number of non-contractible electric loops in each direction.
On the other hand, the operators $\Wilson_i$ introduces a non-contractible electric loop in the $\hat{i}$ direction, which explains \eqref{eq:action_W_on_sectors} .
This can be seen in Fig.~\ref{fig:sector_mapping}.
Notice that in the case of $\Z_2$ \ac{lgt} we can have at most one non-trivial electric loops.
For examples, two parallels electric loops can be obtained by a strip of $B_p$ operators, without requiring the $\Wilson$ string operators.
